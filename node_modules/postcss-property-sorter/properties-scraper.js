var https = require('https');
var fs = require('fs');

var isProperty = function (element) {
  return element.type === 'Properties';
};

var extractName = function (element) {
  return element.name;
};

var options = {
  hostname: 'docs.devdocs.io',
  port: 443,
  path: '/css/index.json'
};

var request = https.get(options, function (result) {
  var data = '',
    filtered = [],
    cssProperties = [];

  result.setEncoding('utf8');

  result.on('data', function (chunk) {
    data += chunk;
  });

  // Write a filtered array of CSS properties to a JSON file
  result.on('end', function () {
    data = JSON.parse(data);
    filtered = data.entries.filter(isProperty);
    cssProperties = filtered.map(extractName);
    cssProperties = JSON.stringify(cssProperties, null, 2);

    fs.writeFile('plans/alphabetical.json', cssProperties, function (error) {
      if (error) throw error;
    });
  });
});

request.on('error', function (error) {
  console.error(error);
});
